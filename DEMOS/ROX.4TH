
CREATE _ROCK1
  0 W, 0 W, 0 W, 2 W, 3 W,
BINARY
 0000001110000000 W, 0000000000000000 W,
 0000011111000000 W, 0000001110000000 W,
 0000111111100000 W, 0000011111000000 W,
 0001111111110000 W, 0000111111100000 W,
 0011111111111000 W, 0001111111110000 W,
 0111111111111100 W, 0011001110011000 W,
 1111111111111110 W, 0111111111111100 W,
 1111111111111110 W, 0111111111111100 W,
 1111111111111110 W, 0000001110000000 W,
 0000011111000000 W, 0000011011000000 W,
 0001111011110000 W, 0000110001100000 W,
 0011110001111000 W, 0001100000110000 W,
 0111100000111100 W, 0011000000011000 W,
 1111000000011110 W, 0111000000011100 W,
 1111000000011110 W, 0000000000000000 W,
 0000000000000000 W, 0000000000000000 W,
DECIMAL

CREATE _ROCK2
  0 W,  0 W, 0 W, 10 W, 8 W,
BINARY
  0000000000000000 W, 0000000000000000 W,
  0001110000111000 W, 0000000000000000 W,
  0001111001111000 W, 0000110000110000 W,
  0000111111110000 W, 0000011001100000 W,
  0000011111100000 W, 0000001111000000 W,
  0000111111110000 W, 0000011111100000 W,
  0001111111111000 W, 0000111111110000 W,
  0011111111111100 W, 0001111111111000 W,
  1111111111111111 W, 0111111111111110 W,
  1110001111000111 W, 0110001111000110 W,
  1111111111111111 W, 0111111111111110 W,
  0001111111111000 W, 0000111111110000 W,
  0011110000111100 W, 0001100000011000 W,
  0111100000011110 W, 0011000000001100 W,
  0011110000111100 W, 0001100000011000 W,
  0001111001111000 W, 0000000000000000 W,
DECIMAL

CREATE _ROCK3
  0 W,   0 W, 0 W, 10 W, 11 W,
BINARY
  0000000000000000 W, 0000000000000000 W,
  1111000000001111 W, 0000000000000000 W,
  1111000000001111 W, 0110000000000110 W,
  1111000000001111 W, 0110000000000110 W,
  1111000110001111 W, 0110000000000110 W,
  1111001111001111 W, 0110000110000110 W,
  1111111111111111 W, 0110001111000110 W,
  1111110000111111 W, 0111110000111110 W,
  1111110000111111 W, 0111110000111110 W,
  1111111111111111 W, 0110001111000110 W,
  1111001111001111 W, 0110000110000110 W,
  1111000110001111 W, 0110000000000110 W,
  1111000000001111 W, 0110000000000110 W,
  1111000000001111 W, 0110000000000110 W,
  1111000000001111 W, 0000000000000000 W,
  0000000000000000 W, 0000000000000000 W,
DECIMAL

CREATE _ROCK4
  0 W, 0 W, 0 W, 15 W, 10 W,
BINARY
  0000000000000000 W, 0000000000000000 W,
  0011111111111000 W, 0000000000000000 W,
  0111111111111111 W, 0000000000000000 W,
  0111111111111111 W, 0000000111111110 W,
  0111111100110011 W, 0000001100110011 W,
  0011111111111111 W, 0000001111111110 W,
  0000111111111110 W, 0000000000000000 W,
  0000111111111000 W, 0000000000000000 W,
  0001111111111100 W, 0011000000000000 W,
  0001111111111100 W, 0011000000000000 W,
  0001111111111100 W, 0011000000011100 W,
  0001111111111100 W, 0011000000011100 W,
  0000011111100000 W, 0000000000000000 W,
  0000111011110000 W, 0000100000000000 W,
  0001110001110110 W, 0001110000110110 W,
  0000111000111100 W, 0000111000111100 W,
DECIMAL

CREATE _RBUFF1 266 ALLOT  CREATE _RBUFF2 266 ALLOT
CREATE _RBUFF3 266 ALLOT  CREATE _RBUFF4 266 ALLOT
CREATE _RBUFF5 266 ALLOT
CREATE _RBUFFA 266 ALLOT  CREATE _RBUFFB 266 ALLOT
CREATE _RBUFFC 266 ALLOT  CREATE _RBUFFD 266 ALLOT
CREATE _RBUFFE 266 ALLOT

VARIABLE _ALTPAGE  VARIABLE _OLDBASE

VARIABLE _R1X  VARIABLE _R1Y VARIABLE _1DT VARIABLE _1T
VARIABLE _R2X  VARIABLE _R2Y VARIABLE _2DT VARIABLE _2T
VARIABLE _R3X  VARIABLE _R3Y VARIABLE _3DT VARIABLE _3T
VARIABLE _R4X  VARIABLE _R4Y VARIABLE _4DT VARIABLE _4T
VARIABLE _R1   VARIABLE _R2  VARIABLE _R3  VARIABLE _R4
VARIABLE _R5X  VARIABLE _R5Y VARIABLE _5DT VARIABLE _5T

: DOROX _R1X @ _R1Y @ _ROCK1 _RBUFF1 SPRITE
        _R2X @ _R2Y @ _ROCK2 _RBUFF2 SPRITE
        _R3X @ _R3Y @ _ROCK3 _RBUFF3 SPRITE
        _R4X @ _R4Y @ _ROCK4 _RBUFF4 SPRITE
        _R5X @ _R5Y @ _ROCK1 _RBUFF5 SPRITE
;
: DOUNROX _RBUFF5 UNSPRITE
 _RBUFF4 UNSPRITE _RBUFF3 UNSPRITE _RBUFF2 UNSPRITE
    _RBUFF1 UNSPRITE ;

: DOROX2 _R1X @ _R1Y @ _ROCK1 _RBUFFA SPRITE
         _R2X @ _R2Y @ _ROCK2 _RBUFFB SPRITE
         _R3X @ _R3Y @ _ROCK3 _RBUFFC SPRITE
         _R4X @ _R4Y @ _ROCK4 _RBUFFD SPRITE
         _R5X @ _R5Y @ _ROCK1 _RBUFFE SPRITE ;

: DOUNROX2   _RBUFFE UNSPRITE
    _RBUFFD UNSPRITE _RBUFFC UNSPRITE _RBUFFB UNSPRITE
     _RBUFFA UNSPRITE ;


: DRAWROX 60SYNCH
      _ALTPAGE @ NEGATE DUP _ALTPAGE !
      SCREENBASE + DUP SETLOG _ALTPAGE @ 0> IF
      DOUNROX DOROX ELSE DOUNROX2 DOROX2 THEN
      SETPHYS 60SYNCH
;

: CLEARIT 266 0 FILL ;

: INIT LOWRES C-OFF
       32000 _ALTPAGE !
       SCREENBASE 32000 - 0 GRAFCLEAR
       RANDOM 75 MOD _R1 !
       RANDOM 75 MOD _R2 !
       RANDOM 75 MOD _R3 !
       RANDOM 75 MOD _R4 !
       RANDOM 9 MOD 2+ _1DT !
       RANDOM 9 MOD 2+ _2DT !
       RANDOM 9 MOD 2+ _3DT !
       RANDOM 9 MOD 2+ _4DT !
       RANDOM 9 MOD 2+ _5DT !
;

: WRITEBLURB
   1 1 GOTOXY
   ." FUSION Corp presents:" CR 27 EMIT ." bb"
   ."   ROX" 27 EMIT ." bo"
   ."  by Nick Porcino" CR
   ."  written in Fusion FORTH" CR
   ."  copyright (C)1986"
   3 SETCOLOR 2 3 199 46 FRAME ;

: GETIT OVER OVER GETPIXEL SETCOLOR OVER OVER PLOT ;

: FADEBLURB SCREENBASE 32000 - SETLOG WRITEBLURB
   5000 0 DO
      RANDOM 100 MOD 2*  RANDOM 25 MOD 2* GETIT
      1+ GETIT SWAP 1+ SWAP GETIT 1- GETIT SWAP 1- SWAP GETIT
      DROP DROP
   LOOP SCREENBASE SETLOG WRITEBLURB ;

: DRAWSTUFF  15 SETCOLOR
      500 0 DO RANDOM 320 MOD RANDOM 200 MOD PLOT LOOP
   1 SETCOLOR         HOME
   180 0 DO 15 FORWARD I 10 * 1+ RIGHT LOOP FADEBLURB
 ;

: ANIMATE SCREENBASE _OLDBASE ! INIT
   DRAWSTUFF  SCREENBASE SCREENBASE 32000 - 32000 CMOVE

     BEGIN
       _R1 @ _1T @ *SIN 155 + _R1X !    ( SEESAW )
       _R1 @ _1T @ *SIN  85 + _R1Y !
       75 _5T @ *SIN _2T @ *COS 160 + _R2X !   ( CRAZY)
       _R2 @ _2T @ *SIN 100 + _R2Y !
       75 _2T @ *SIN _1T @ *COS 162 + _R3X !   ( CRAZY )
       75 _3T @ *SIN _4T @ *SIN 88 +  _R3Y !
       _R4 @ _3T @ *SIN 152 + _R4X !        ( CRAZY )
       75 _1T @ *SIN _2T @ *COS 105 + _R4Y !
       75 _4T @ *SIN _5T @ *COS 170 + _R5X !    ( CRAZY )
       75 _4T @ *SIN _3T @ *SIN 95 + _R5Y !
       DRAWROX
       _1T @ _1DT @ + 360 MOD _1T !
       _2T @ _2DT @ + 360 MOD _2T !
       _3T @ _3DT @ + 360 MOD _3T !
       _4T @ _4DT @ + 360 MOD _4T !
       _5T @ _5DT @ + 360 MOD _5T !
     ?KEY UNTIL KEY DROP  _OLDBASE @ DUP SETPHYS SETLOG
;

: GOODBYE PAGE 0 1 GOTOXY
   ." ROX is written in FUSION FORTH," CR
   ."   a complete ST development system." CR CR
   ." Fusion FORTH gives you full access to" CR
   ." the ST's hardware:" CR 27 EMIT ." bb"
   ."          SOUND" CR
   ."         GRAPHICS" CR
   ."       3D GRAPHICS" CR
   ."      TURTLE GRAPHICS" CR
   ."       BIOS and XBIOS" CR
   ."       DISK HANDLING" CR
   ."     FULL MOUSE CONTROL" CR
   ." WINDOWS, SLIDERS, BUTTONS, MENUS" CR CR 27 EMIT ." bo"
   ." Fusion FORTH is fully 20% faster than" CR
   ."  ANY other FORTH implementation we've" CR
   ."  seen on the ST." CR CR
   ." For more information write to:" CR 27 EMIT ." bb"
   ."  FusionCorp" CR
   ."  #711-725 12Ave SW" CR
   ."  Calgary Alberta  T2R-0H9" CR
   ."  Canada" CR  C-OFF KEY DROP ;

: COLD COLDSTUFF ANIMATE GOODBYE
   STARTREZ @ GETREZ <>
   IF GETREZ 2 <> IF MEDRES THEN THEN
   0 L>W 1 GEMDOS ;

' COLD ORG - STARTWORD !

.( ANIMATE runs the demo )

QUIT

